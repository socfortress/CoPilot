import { type FlaskBaseResponse } from "@/types/flask.d"
import { HttpClient } from "./httpClient"
import type { NucleiReport, ScanHostPayload } from "@/types/webVulnerabilityAssessment.d"

export default {
	getAllReports() {
		return HttpClient.get<FlaskBaseResponse & { reports: NucleiReport[] }>(`/nuclei/all_reports`)
	},
	getReport(host: string, reportPage: string) {
		return HttpClient.get<FlaskBaseResponse & { markdown: string }>(`/nuclei/report/${host}/${reportPage}`)
	},
	scan(payload: ScanHostPayload) {
		return HttpClient.post<FlaskBaseResponse>(`/nuclei/scan`, payload)
	},
	deleteReport(host: string) {
		return HttpClient.delete<FlaskBaseResponse>(`/nuclei/delete_report/${host}`)
	}
}
